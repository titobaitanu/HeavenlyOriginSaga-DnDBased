# ============================================================
# SYSTEM MODULE — FORGING SHEET
# Repository Path: system_modules/system/forging_sheet.yaml
# Version: v3.2-secure
# Maintainer: Heavenal Control Node
# License: Dual (MIT + Heavenal Law Open-Collab)
# ============================================================

meta:
  module_id: "SYS-FRG"
  title: "Heavenal Forging & Weaponcrafting Simulation Sheet"
  version: 3.2-secure
  author: "Tito Baitanu"
  maintainer: "Heavenal Control Node"
  category: "System Module"
  status: verified
  linked_files:
    - codex_alchemy_forging.yaml
    - codex_heavenal_shop.yaml
    - artifacts_10000.json
    - forging_tools_2000.json
    - json_binding_map.yaml
  registry_path: "system_modules/system/forging_sheet.yaml"
  last_updated: "2025-11-10"

description:
  purpose: >
    Modul forging mengatur pembuatan, peningkatan, fusion, dan penempaan artefak/senjata.
    Menyediakan aturan sukses/gagal, requirement cauldron-forge synergies, konsumable catalyst,
    dan efek law/essence pada item yang dihasilkan.
  design_principles:
    - "Forging adalah harmonisasi antara materi, hukum, dan tenaga pengguna."
    - "Risiko dan reward skala besar untuk item G7–G9 agar ekonomi dan konflik tetap seimbang."
    - "Item mortal tidak boleh menyalip item immortal tanpa mekanik khusus."

core_mechanics:
  workflow:
    - step_1: "Select Forge Recipe / Blueprint (artifact catalog or GM blueprint)."
    - step_2: "Assemble Materials (ore, spirit-essence, catalyst, core crystal)."
    - step_3: "Choose Forge Tool & Cauldron / Anvil (linked forging_tools_2000.json)."
    - step_4: "Bind Law / Essence (optionally use Law Imprint if user qualifies)."
    - step_5: "Adjust Heat & Resonance (User Strength, Technique, and Fire Qi factor)."
    - step_6: "Roll Outcome (Success / Partial / Failure / Overforge / Void-imbue)."
    - step_7: "Post-process: Tempering, Imbuing, Soulforging, or Binding."

success_rate_formula:
  base_rate: "25 + (forging_skill × 2) + (intelligence × 0.4) + (forge_tool_quality × 3)"
  modifiers:
    - "Material Purity: +1% to +20%"
    - "Catalyst Grade: +2% to +30% (stackable up to +60%)"
    - "Cauldron/Anvil Tier Sync: +0% to +25%"
    - "Law Comprehension Bonus: up to +20% (bounded by cap)"
    - "Realm Modifier: +5% per realm above Mortal"
  difficulty_penalty:
    - "Attempting to craft > user_allowed_grade → −(10 × grade_difference)%"
    - "Using low-quality tools on high-grade recipe → −(5 × grade_difference)%"
  critical_outcome_table:
    - "Critical Success (roll ≥ 95): Item gains 'Awakened' trait (bonus stats & minor soul resonance)."
    - "Major Success (roll 75–94): Full quality item produced."
    - "Partial Success (roll 50–74): Item produced but degraded (−1 grade or random flaw)."
    - "Failure (roll 20–49): Materials consumed, no item; moderate Qi/Fire damage to crafter."
    - "Catastrophic Failure (roll <20): Forge explosion, possible item corruption to 'Cursed Relic'."

grading_system:
  item_grades:
    - G1–G3: "Common — suitable for mortal tier."
    - G4–G6: "Rare — aspirational for high mortal / low immortal."
    - G7–G8: "Legendary — triggers political interest and sect raids."
    - G9: "Prime Heavensmith Artefact — restricted, auction / divine permit required."
  crafting_requirements:
    - "Crafter Rank ≥ (Item Grade × 2) for normal crafting."
    - "Forge Tool Tier ≥ ceil(Item Grade / 2)."
    - "Law Cap / Realm check: certain imprints require minimum law comprehension or realm status."
    - "Special blueprints (G8–G9) require permit or rare blueprint (auction / quest)."

fusion_and_enchantment:
  fusion_types:
    - "Fusion (Weapon + Soul Core) → Weapon with Soul Resonance"
    - "Imbuement (Weapon + Pill Essence) → Temporary Law Sync"
    - "Alloy Fusion (multiple ores) → Stat multipliers or new properties"
  fusion_rules:
    - "Fusion success uses combined success_rate_formula with additional catalyst multiplier."
    - "Transferring unique traits from base items costs Essence tokens or Spirit Stones."
    - "Fusion may create side-effects: resonance clash, soul strain, or law leakage."
  enchantment_slots:
    - "Basic Slots: 1–2 for G1–G3"
    - "Advanced Slots: 3–5 for G4–G6"
    - "Prime Slots: 6+ for G7–G9 (require special soul cores)"

law_imprint_mechanics:
  imprint_types:
    - "Temporary Imprint (duration-limited; small law bonus)."
    - "Permanent Imprint (consumes rare Divine Crystal; binds law to item)."
    - "Soul Imprint (binds user's soul fragment; item becomes 'Bound' to user)."
  imprint_requirements:
    - "User Law Comprehension must meet imprint threshold (see codex_law_limits)."
    - "Divine materials required for permanent imprint (Immortal Jade / Divine Crystal)."
  imprint_risks:
    - "Law overstrain → item becomes unstable, may trigger Heavenal attention if excessive."
    - "Imprint theft attempts trigger Karmic Trace."

upgrade_and_reforge:
  upgrade_paths:
    - "Tier Upgrade: Increase item grade by re-forging with higher-tier materials & catalysts."
    - "Soulthaw: Recover lost stats from degraded items (requires Soulforging ritual)."
  reforge_penalties:
    - "Each failed upgrade reduces base durability and increases chance of flaw."
    - "Reforges beyond grade cap require divine permit or Law Compression ritual."

economy_and_trade:
  marketplace_rules:
    - "Mortal shops cannot list >G6 items."
    - "Legendary items (G7–G8) sold via elite auctions or black market (GCEB monitoring)."
    - "G9 artefacts require Divine Permit and auction in Great Heaven or sealed exchange."
  pricing_factors:
    - "Material Scarcity, Crafter Reputation, Enchantment Slots, Soul Resonance, Rarity Index"
  trade_controls:
    - "Large transfers of rare artifacts flagged by Karmic Trace for GCEB review."

linked_data:
  sources:
    - artifacts_10000.json
    - forging_tools_2000.json
    - catalyst_catalog_2000.json
    - json_binding_map.yaml
  import_method: "Dynamic JSON Binding"
  validation:
    checksum: verified
    schema_version: 2.1
    import_status: success
  restock_and_consumables:
    - "Forge tools have durability; crafting consumes repair materials and catalysts."
    - "Some rare catalysts single-use (consumed on success)."

gameplay_rolls_and_examples:
  sample_rolls:
    - description: "Crafter A (Forging Skill 12) attempts G5 sword with tool quality 4 and catalyst +15%."
      compute:
        base_rate: "25 + (12×2) + (INT×0.4) + (4×3) => (INT assumed 10) => 25+24+4+12 = 65%"
        modifiers: "+MaterialPurity(10%) + Catalyst(15%) => total 90%"
        result_hint: "High chance success; roll needed under 90 on d100."
  dice_system:
    - "All forging checks use d100 (1–100)."
    - "Additive bonuses applied to success chance; critical thresholds as defined above."

safety_and_gceb_integration:
  monitoring:
    - "Attempts to craft items with illegal law imprints trigger immediate Karmic Trace."
    - "GCEB auditors may confiscate corrupted or rogue artefacts."
  containment:
    - "Catastrophic forging events may spawn containment field and require Silent Hunters response."

verification:
  maintained_by: "Heavenal Control Node"
  validated_on: "2025-11-10"
  sync_with: "manifest.yaml v3.2-secure"
  integrity_check: verified
  checksum: "SYS-FRG-SHA-7A1D3B"
  sign_key: "HCLN-FORGING-SYS-SECURE"
