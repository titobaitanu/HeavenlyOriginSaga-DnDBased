# ============================================================
# EVENT/ASCENSION_TRIAL.YAML — HEAVENLY ORIGIN SAGA
# Secure Public Version (v3.2)
# Repository Path: event/ascension_trial.yaml
# Maintainer: Heavenal Control Node
# License: Dual (MIT + Heavenal Law Open-Collab)
# ============================================================

meta:
  event_id: "EVT-ASC"
  title: "Ascension & Tribulation Trial System"
  version: 3.2-secure
  author: "Tito Baitanu"
  maintainer: "Heavenal Control Node"
  repository_link: "HeavenlyOriginSaga-DnDBased"
  classification: "Event Engine Subsystem — Ascension Mechanics"
  status: verified
  checksum: "EVT-ASC-SHA-5F8B1"
  last_updated: "2025-11-11"

introduction:
  description: >
    The Ascension Trial System governs every formal attempt by a cultivator
    to raise their level (per-level tribulation) and to cross realm boundaries
    (e.g., Mortal→Immortal, Immortal→Divine). Trials are the Law's response
    to changes in a soul's causal weight and are mandatory to preserve cosmic balance.
  guiding_principle: |
    "Every step up in realm reshapes destiny; Heaven tests those who touch its fabric."

core_concepts:
  - per_level_tribulation: "A tribulation event occurs at every single level increase (e.g., Immortal Langit Lv.12 → Lv.13)."
  - realm_gate_ascension: "Special higher-impact trial when crossing major realm thresholds (e.g., Half-Immortal Lv.10 → Enter Immortal Langit Lv.1)."
  - trial_tiers:
      - "Minor (per-level within same realm, predictable)"
      - "Major (realm boundary crossings / notable law compression events)"
      - "Divine (crossing into Deity realms or altering world-level laws)"
  - law_cap_reference:
      - mortal_law_cap: 1.5
      - immortal_law_cap: 5.0
      - divine_law_cap: 7.0

success_chance_model:
  base_success_chance:
    - "Minor Trial: 95% base"
    - "Major Trial: 60% base"
    - "Divine Trial: 15% base"
  roll_mechanic: "d100 + modifiers vs target 100 (success if >= target threshold defined per trial type)."
  sample_thresholds:
    - minor_threshold: 60  # lower threshold for simplicity (d100 + mods >= 60)
    - major_threshold: 85
    - divine_threshold: 140  # effectively requires large positive modifier
  note: >
    Base probabilities are converted into equivalent d100 thresholds; GM can compute either
    as direct % or as threshold rolls. System modules will standardize to d100 evaluation.

modifiers:
  positive_modifiers:
    - name: "Heavenal Blessing"
      type: "percent"
      effect: "+10 to +40 (depends on blessing tier)"
      source: "Heavenal Node, divine NPCs"
    - name: "Law Compression Technique"
      type: "flat"
      effect: "+5 to +25"
      requirement: "Law Comprehension > 2 for stronger effect"
    - name: "Group Aid (Ritual Network)"
      type: "flat"
      effect: "+2 per assisting ritualist (max +20)"
      note: "Assistants sacrifice Qi/spirit as cost"
    - name: "High-Grade Cauldron / Pill"
      type: "flat"
      effect: "+10 to +50 depending on grade (Cauldron I–IX / Pill G1–G9)"
      requirement: "Cauldron grade >= target trial grade"
    - name: "Karma Favor"
      type: "percent"
      effect: "Converted into +1 per +100 KP positive (cap +30)"
      source: "systems/karma_system.yaml"
    - name: "Artifact / Relic"
      type: "flat"
      effect: "+5 to +80 (artifact tier dependent)"
      notes: "High-tier Divine artefacts may multiply modifier"
  negative_modifiers:
    - name: "Karmic Debt"
      type: "flat"
      effect: "-1 per 100 negative KP (uncapped)"
    - name: "Soul Fracture / Instability"
      type: "flat"
      effect: "-10 to -60"
      source: "previous failed tribulations or law misuse"
    - name: "Environmental Interference (Chaos / Void Presence)"
      type: "flat"
      effect: "-15 to -90 depending on contamination"
    - name: "Improper Cauldron / Pill Grade"
      type: "flat"
      effect: "-10 if cauldron < required grade for pill"
  law_comprehension_modifier:
    description: >
      Law Comprehension (LC) provides a small steady modifier per 0.1 increment.
      Example: LC × 2 (flat bonus) — but note global caps apply (mortal/immortal/divine caps).
    sample:
      - LC 1.0 → +2 flat
      - LC 5.0 → +10 flat

calculation_flow:
  1: "System computes base threshold for the trial type (minor/major/divine)."
  2: "Aggregate all positive and negative modifiers from character, items, allies, environment, karma, and cauldron/pill state."
  3: "Player / GM rolls d100; result + aggregate modifiers."
  4: "If (roll + modifiers) >= threshold → success. Else → failure with graded consequences."
  5: "System logs event to Heavenal Archive and updates karma/reputation/tribulation history."

failure_outcomes:
  graded_failures:
    - partial_failure:
        condition: "(roll + modifiers) within 1–25% below threshold"
        effects:
          - "Lose a portion of Qi & Spirit (10%–30%)"
          - "Temporary meridian crippling (hours → weeks depending on realm)"
          - "Minor soul scar (−5% soul stability)"
          - "Increased Tribulation Risk multiplier for next attempt: +5%"
    - severe_failure:
        condition: "(roll + modifiers) 26–60% below threshold"
        effects:
          - "Major loss of cultivation levels (1–3 levels lost)"
          - "Soul fracture: reduced Law Resonance and Soul Stability (−10%–40%)"
          - "Permanent reduction of some stat caps until repaired"
          - "May trigger GCEB flag if law misuse were involved"
    - catastrophic_failure:
        condition: "(roll + modifiers) > 60% below threshold"
        effects:
          - "Heavenal Burn: possible annihilation of soul (death) or transmigration into lower plane"
          - "If death occurs, reincarnation rules invoke Rebirth System (aux: codex_rebirth)"
          - "Severe reality scars: local law distortions requiring Great Court review"
  auto_fail_triggers:
    - "Use of forbidden Law Arts during trial → immediate catastrophic failure chance +50%."
    - "Cauldron mismatch (attempting G8 pill with G6 cauldron) → immediate -40 modifier"
  mitigation_on_fail:
    - "Emergency Pill (limited supply) can reduce severity by 1 tier if consumed pre-failure (requires roll)."
    - "Heavenal Seal activation by GCEB may contain damage but costs reputation & karma."

success_outcomes:
  immediate_benefits:
    - "Increase to target level (level up)."
    - "Possible unlocking of new minor technique or soul trait (roll for boon)."
    - "Heavenal Favor: small permanent karma increment (+10–+200 depending on trial)."
    - "Access to certain shops/auctions or faction ranks automatically unlocked (if criteria met)."
  bonus_rolls:
    - "If roll exceeds threshold by >30, additional blessing roll (d100) for rare boons."
    - "Extra Law Resonance points (temporary) that can be banked for later Law Compression tasks."
  realm_crossing_success:
    - "Special artifact attunement (if used) becomes permanent (e.g., Immortal Jade bonded)."
    - "Granting of Ascension Title and registered in Heavenal Archive."

special_rules:
  per_level_frequency:
    - "Tribulation occurs every level increase. For characters leveling multiple levels at once (rare), trials happen sequentially with cumulative modifiers."
  assisted_ascension:
    - "Group rituals permit pooled modifiers but require assistants to expend Qi/Spirit proportional to their contribution."
  forbidden_supports:
    - "Buying success with world-altering Law Writing is illegal and flagged by Great Court: immediate investigation & possible sanction."
  hidden_checks:
    - "Heavenal Node may apply secret adaptive modifiers (Law Balance) to prevent systemic exploits. These modifiers are audited and revealed only in Tribunal cases."
  ascension_cooldown:
    - "Each failed ascension increases 'Tribulation Heat' on the character: +X% fail chance per failure. Cooldown reduction possible by cleansing rituals, karma repair, or time (Heaven Timer)."

integration_points:
  linked_systems:
    - "systems/karma_system.yaml (Karma affects modifiers & may trigger Tribunal reviews)"
    - "systems/ascension_trial.yaml (this file — primary)"
    - "systems/law_comprehension_engine.yaml (LC modifiers)"
    - "systems/heaven_timer.yaml (timed cooldowns & ritual windows)"
    - "systems/alchemy_sheet.yaml (pill/cauldron validation and grade checks)"
    - "event/world_event_engine.yaml (realm-wide events can increase difficulty)"
    - "npc/faction_index.yaml (faction aid & permits)"
  GCEB_intervention:
    - "Major or Divine trial failures with law-use implications automatically notify GCEB for containment and possible prosecution."

gm_guidelines:
  pre_trial_checks:
    - "Verify cauldron grade and pill compatibility: mismatch = -40."
    - "Check Karma: negative KP > 1000 → impose additional penalty."
    - "Check Law Cap: if character's LC > allowed cap for realm, trial is forbidden without special dispensation."
  suggested_difficulty_scaling:
    - "For narrative-driven content, GM may add environmental penalties (+10 to +50) for dramatic trials."
    - "For speed-run campaigns, lower Major threshold by 10–15 for accessibility (note audit)."
  documentation:
    - "Log all trial attempts to Heavenal Archive (for audit & story continuity)."
    - "Note permanent changes (titles, bonded artifacts) in player manifest."

example_scenarios:
  scenario_1:
    description: "Mortal Nascent Soul (Lv. Nascent 5 → Nascent 6) attempting minor trial."
    base_threshold: 60
    modifiers:
      - Law_Comprehension: 0.5 → +1
      - Karma: +300 → +3
      - High-Grade Pill (G3) → +12
      - Assistants (2 ritualists) → +4
    roll_example:
      - "Player rolls d100 = 42"
      - "Total = 42 + 1 + 3 + 12 + 4 = 62 → >= 60 ⇒ Success"
  scenario_2:
    description: "Immortal (Kaisar Immortal Lv.1 → Lv.2) Major Trial."
    base_threshold: 85
    modifiers:
      - LC: 4.2 → +8
      - Karma: -800 → -8
      - Heavenal Blessing (minor) → +10
      - Artifact (mid-tier) → +20
    roll_example:
      - "Player rolls d100 = 50"
      - "Total = 50 + 8 - 8 + 10 + 20 = 80 → < 85 ⇒ Partial Failure (see failure table)"

audit_and_security:
  logging:
    - "All ascension attempts produce an immutable Heavenal Log entry with: timestamp, actor, realm-target, modifiers snapshot, roll_result, consequence."
  secret_modifiers:
    - "Heavenal Node may insert internal 'Balance Modifiers' for meta-stability; these are auditable only during Tribunal review."
  sanctions:
    - "Deliberate law-manipulation to force trial success → GCEB prosecution and potential Law Seal (1000–10000 Heavenal Days)."

recovery_paths:
  - "Cleansing Rituals: reduce soul fracture severity (requires rare herbs/pill & ritual site)."
  - "Reincarnation Path: fatal failures lead to Rebirth options per codex_rebirth; memory sealing/partial return choices available to high-tier players."
  - "Tribulation Insurance (rare service by Alchemist Tower / Merchant Alliance): pays partial restoration cost if purchased prior to trial."

verification:
  maintained_by: "Heavenal Control Node"
  validated_on: "2025-11-11"
  sync_with: "manifest.yaml v3.2-secure"
  integrity_check: verified
  checksum: "EVT-ASC-SHA-5F8B1"
  sign_key: "HCLN-ASC-TRIAL-SECURE"
